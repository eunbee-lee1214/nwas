(function(){"use strict";var e={3668:function(e,t,a){var n=a(5130);async function l(){const e=await a.e(53).then(a.t.bind(a,8874,23));e.load({google:{families:["Roboto:100,300,400,500,700,900&display=swap"]}})}var o=a(5015),u=a(2261),i=a(6768),s=(a(4114),a(144)),r=a(4232),d=a(1387);const c=(0,u.nY)("progressStore",(()=>{var e=(0,s.KR)(1);const t=(0,s.KR)({step1:!0,step2:!1,step3:!1,step4:!1});function a(a,n){t.value[a]=n,e=a.replace(/\D/g,"")}function n(e){return t.value[e]||!1}function l(){return t}return{currentStep:e,stepConditions:t,setStepCondition:a,isStepCompleted:n,allstepCondition:l}}));var p=a.p+"img/mrtLogo.0f360cf5.png",m=a(554),v=a(2729),f=a(1606),y=a(697),g=a(3745),b=a(1772);const k={class:"logo"},h=["src"],w={class:"menu"},C=["onClick"],_={class:"material-icons"},L={class:"text"};var F={__name:"SideBar",setup(e){const t=(0,d.lq)(),a=(0,d.rd)(),n=c();var l=(0,s.KR)("");const o=(0,s.KR)(!1),u=[{path:"/step1",name:"송배전망 배치",label:"STEP1",key:"step1"},{path:"/step2",name:"리스트 생성",label:"STEP2",key:"step2"},{path:"/step3",name:"좌표설정",label:"STEP3",key:"step3"},{path:"/step4",name:"결과출력",label:"STEP4",key:"step4"}],F=e=>t.path===e,I=e=>(0,i.EW)((()=>n.isStepCompleted(e))).value,E=(e,t)=>{n.isStepCompleted(t)||"/step1"===e?a.push(e):(l="이전 Step을 완료해야 이동할 수 있습니다.",o.value=!0)};return(e,t)=>((0,i.uX)(),(0,i.CE)(i.FK,null,[(0,i.Lk)("aside",null,[(0,i.Lk)("div",k,[(0,i.Lk)("img",{src:(0,s.R1)(p),alt:"Vue"},null,8,h)]),(0,i.Lk)("div",w,[((0,i.uX)(),(0,i.CE)(i.FK,null,(0,i.pI)(u,(e=>(0,i.Lk)("div",{key:e.path,class:(0,r.C4)(["button",{active:F(e.path),completed:I(e.key)}]),onClick:t=>E(e.path,e.key)},[(0,i.Lk)("span",_,(0,r.v_)(e.label),1),(0,i.Lk)("span",L,(0,r.v_)(e.name),1)],10,C))),64))])]),(0,i.bF)(b.p,{modelValue:o.value,"onUpdate:modelValue":t[1]||(t[1]=e=>o.value=e),"max-width":"400px"},{default:(0,i.k6)((()=>[(0,i.bF)(v.J,null,{default:(0,i.k6)((()=>[(0,i.bF)(f.r,null,{default:(0,i.k6)((()=>t[2]||(t[2]=[(0,i.eW)(" 경고 ")]))),_:1}),(0,i.bF)(y.O,null,{default:(0,i.k6)((()=>[(0,i.eW)((0,r.v_)((0,s.R1)(l)),1)])),_:1}),(0,i.bF)(g.S,null,{default:(0,i.k6)((()=>[(0,i.bF)(m.D,{color:"primary",onClick:t[0]||(t[0]=e=>o.value=!1)},{default:(0,i.k6)((()=>t[3]||(t[3]=[(0,i.eW)("닫기")]))),_:1})])),_:1})])),_:1})])),_:1},8,["modelValue"])],64))}},I=a(1241);const E=(0,I.A)(F,[["__scopeId","data-v-7e2a2bc3"]]);var S=E;a(8111),a(2489),a(116),a(7588),a(1701),a(3579);const W=(0,u.nY)("dropZoneStore",(()=>{const e=(0,s.KR)([{id:1,name:"발전소",items:[],isValid:!0},{id:2,name:"765kV",items:[],isValid:!0},{id:3,name:"345kV",items:[],isValid:!0},{id:4,name:"154kV",items:[],isValid:!0},{id:5,name:"22.9kV",items:[],isValid:!0},{id:6,name:"수요지역",items:[],isValid:!0},{id:7,name:"NWAs",items:[],isValid:!0}]);let t=0;const a=e=>{const t="ABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let a=0;a<t.length;a++){const n=t[a];if(!e.includes(n))return n}return null},n=(t,n)=>{const l=e.value.find((e=>e.id===t));if(t===n.id&&l){const e=l.items.filter((e=>e.label.startsWith(n.label+"-"))).map((e=>e.label.split("-")[1])).filter((e=>/^[A-Z]$/.test(e))),t=a(e),o=t?`${n.label}-${t}`:n.label,u={...n,label:o,uniqueId:crypto.randomUUID(),lat:0,lng:0};l.items.push(u)}o()},l=(a,n,l)=>{const u=e.value.find((e=>6===e.id));u&&(u.items=[{label:"수요지역",id:6,property:[{name:"주소",values:[{data:a,unit:"-",modify:!1}]},{name:"용량",values:[{data:n,unit:"MW",modify:!1}]},{name:"일별 전력 사용시간",values:[{data:l,unit:"hr/day",modify:!1}]}],uniqueId:crypto.randomUUID(),lat:0,lng:0,setProperty:!0}],t=n),o()},o=()=>{e.value.forEach((e=>{e.items.forEach((e=>{e.property&&e.property.forEach((a=>{"수요용량"===a.name&&a.values.forEach((a=>{"MW"===a.unit&&(console.log(e.label,"아이템 수요용량 수정"),a.data=t)}))}))}))}))},u=(t,a)=>{const n=e.value.find((e=>e.id===t));n&&(n.items=n.items.filter((e=>e.uniqueId!==a)))},i=t=>{for(const a of e.value){const e=a.items.find((e=>e.uniqueId===t));if(e)return e}return null};return{dropZones:e,addItemToZone:n,saveDemandArea:l,removeItemFromZone:u,getProperty:i}})),x=(0,u.nY)("topologyStore",(()=>{const e=6,t=(0,s.KR)([]),a=a=>!(t.value.length>=e)&&(t.value.includes(a)||t.value.push(a),!0),n=()=>t.value.length>=e,l=e=>{t.value.splice(e,1)},o=e=>{t.value=e},u=()=>{t.value=[]},i=(e,a,n)=>{Array.isArray(t.value)?t.value.forEach((t=>{Array.isArray(t)&&t.forEach((t=>{t.uniqueId===e&&(console.log(`좌표 업데이트: ${e} → lat: ${a}, lng: ${n}`),Object.assign(t,{lat:a,lng:n}))}))})):console.error("topologyList.value가 배열이 아닙니다.",t.value)};return{topologyList:t,addTopology:a,isNotAdd:n,removeTopology:l,setTopologyList:o,clearTopologyList:u,setCoordinates:i}}));var A=a(552),R=a(9930),N=a(3260),O=a(5728);const V={key:0},K={class:"td-value"},D={key:1,class:"blue-text"},P={class:"td-unit"},q={key:0},T={colspan:"3"},X={key:1},M={colspan:"3"},J={key:2},$={colspan:"3"},B={class:"td-item depth-2"},z={class:"td-value"},j={key:1,class:"blue-text"},U={class:"td-unit"},Z={key:4,class:"text-center red-text"},Y={colspan:"3",class:"bold-text"},Q={class:"td-item"},G={class:"td-value"},H={key:1,class:"blue-text"},ee={class:"td-unit"},te={key:1,class:"text-center"};var ae={__name:"GlobalDialog",props:{modelValue:Boolean,label:String,id:Number,uniqueId:String},emits:["update:modelValue","saveData"],setup(e,{emit:t}){const a=x(),n=W(),l=e,o=t,u=(0,s.KR)([]),d=(0,s.KR)(!1),c=(0,s.KR)([]),p=(0,s.KR)("증축"),k=(0,s.KR)("AC"),h=(0,s.KR)("기존"),w=(e,t,a)=>{if(!a||!e.values[t])return;const n=[...e.values];n[t]={...n[t],data:a.target?a.target.value:a},e.values=n};(0,i.wB)((()=>l.uniqueId),(async e=>{if(e){console.log("🛠 다이얼로그 전환, 기존 데이터 초기화"),await(0,i.dY)();let t=n.getProperty(e);t&&t.property&&(c.value=JSON.parse(JSON.stringify(E(t.property)))),console.log("🔍 새롭게 설정된 topologyData:",JSON.stringify(c.value))}}),{immediate:!0,deep:!1});const C=e=>Array.isArray(e)&&e.length>0&&e.some((e=>e.name&&"string"===typeof e.name&&""!==e.name.trim()));(0,i.wB)((()=>l.modelValue),(e=>{d.value=e}));const _=()=>{o("update:modelValue",!1),c.value=[]},L=e=>Array.isArray(e)&&e.length>0&&!e[0].name;(0,i.wB)((()=>n.dropZones),(e=>{e.length>0&&(u.value=JSON.parse(JSON.stringify(e)))}),{deep:!0,immediate:!0});const F=async()=>{const e=u.value.findIndex((e=>e.items.some((e=>e.uniqueId===l.uniqueId))));if(-1===e)return void console.error("❌ 해당 uniqueId를 가진 Zone을 찾을 수 없음");const t=u.value[e].items.findIndex((e=>e.uniqueId===l.uniqueId));if(-1===t)return void console.error("❌ 해당 uniqueId를 가진 Item을 찾을 수 없음");const a=JSON.parse(JSON.stringify(u.value[e].items[t])),s=c.value.map((e=>{if("배전망 건설 단가"===e.name||"발전소 구축단가"===e.name){const t=ae(e);return{name:e.name,values:t.length>0?[{constructionType:"배전망 건설 단가"===e.name?p.value:h.value,..."배전망 건설 단가"===e.name&&{powerType:k.value},costs:t.map((e=>({name:e.name||"이름 없음",data:Number(e.data)||0,unit:e.unit||"",modify:e.modify??!0})))}]:[]}}return{name:e.name,values:e.values.map(((t,a,n)=>({...n.length>1?{name:t.name||e.name}:{},data:Number(t.data)??0,unit:t.unit||"",modify:t.modify??!0})))}}));s.forEach((e=>{delete e.depth,e.values&&e.values.forEach((e=>{delete e.depth}))})),a.property=s;const r=["송전 접속단가","송전 손실단가"],d=s.filter((e=>r.includes(e.name))),m=u.value[e].items[t].property,v=["송전 접속단가","송전 손실단가"].some((e=>{const t=m.find((t=>t.name===e)),a=s.find((t=>t.name===e));return JSON.stringify(t)!==JSON.stringify(a)})),f=!v&&s.some((e=>"송전설로 건설단가"===e.name&&JSON.stringify(e)!==JSON.stringify(m.find((t=>t.name===e.name)))));if(String(a.label).includes("154"))v?u.value.forEach((e=>{e.items.forEach((e=>{if(String(e.label).includes("154")){if(e.uniqueId===l.uniqueId)e.property=JSON.parse(JSON.stringify(s));else{const t=e.property.map((e=>{const t=d.find((t=>t.name===e.name));return t?JSON.parse(JSON.stringify(t)):e}));e.property=t}e.setProperty=!0}}))})):f&&(u.value[e].items[t].property=JSON.parse(JSON.stringify(s)),u.value[e].items[t].setProperty=!0);else{JSON.stringify(s),JSON.stringify(m);u.value[e].items[t].property=JSON.parse(JSON.stringify(s)),u.value[e].items[t].setProperty=!0}n.dropZones=JSON.parse(JSON.stringify(u.value)),I(a),o("saveData",JSON.parse(JSON.stringify(u.value))),await(0,i.dY)(),_()},I=e=>{for(const t of a.topologyList)for(const a of t)if(a.uniqueId===e.uniqueId)return a.property=JSON.parse(JSON.stringify(e.property)),a.setProperty=!0,void console.log("바뀜")},E=(e,t=1)=>e.map((e=>{let a={...JSON.parse(JSON.stringify(e)),depth:t};return Array.isArray(a.values)?a.values=a.values.map((e=>{let a={...JSON.parse(JSON.stringify(e)),depth:t+1};return Array.isArray(a.costs)&&(a.costs=a.costs.map((e=>({...JSON.parse(JSON.stringify(e)),depth:a.depth+1})))),a})):a.values=[],a})),S=e=>"배전망 건설 단가"===e.name||"발전소 구축단가"===e.name,ae=e=>e&&e.values?"배전망 건설 단가"===e.name?e.values.find((e=>e.constructionType===p.value&&e.powerType===k.value))?.costs||[]:"발전소 구축단가"===e.name&&e.values.find((e=>e.constructionType===h.value))?.costs||[]:[];return(t,a)=>c.value.length>0?((0,i.uX)(),(0,i.Wv)(b.p,{key:0,modelValue:d.value,"onUpdate:modelValue":a[3]||(a[3]=e=>d.value=e),"max-width":"600px",persistent:""},{default:(0,i.k6)((()=>[(0,i.bF)(v.J,null,{default:(0,i.k6)((()=>[(0,i.bF)(f.r,{class:"dialog-title"},{default:(0,i.k6)((()=>[(0,i.eW)((0,r.v_)(e.label),1)])),_:1}),(0,i.bF)(y.O,null,{default:(0,i.k6)((()=>[c.value.length?((0,i.uX)(),(0,i.Wv)(N.Z,{key:0,class:"styled-table"},{default:(0,i.k6)((()=>[a[4]||(a[4]=(0,i.Lk)("thead",null,[(0,i.Lk)("tr",null,[(0,i.Lk)("th",{class:"col-item group-header"},"항목"),(0,i.Lk)("th",{class:"col-value group-header"},"값"),(0,i.Lk)("th",{class:"col-unit group-header"},"단위")])],-1)),(0,i.Lk)("tbody",null,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(c.value,((e,t)=>((0,i.uX)(),(0,i.CE)(i.FK,{key:t},[L(e.values)&&"배전망 건설 단가"!==e.name&&"발전소 구축단가"!==e.name?((0,i.uX)(),(0,i.CE)("tr",V,[(0,i.Lk)("td",{class:(0,r.C4)(["td-item",`depth-${e.depth}`])},(0,r.v_)(e.name),3),(0,i.Lk)("td",K,[e.values[0].modify?((0,i.uX)(),(0,i.Wv)(O.W,{key:0,modelValue:e.values[0].data,"onUpdate:modelValue":t=>e.values[0].data=t,dense:"",variant:"plain",type:"number",class:"input-field"},null,8,["modelValue","onUpdate:modelValue"])):((0,i.uX)(),(0,i.CE)("span",D,(0,r.v_)(e.values[0].data),1))]),(0,i.Lk)("td",P,(0,r.v_)(e.values[0]?.unit||""),1)])):S(e)?((0,i.uX)(),(0,i.CE)(i.FK,{key:1},[(0,i.Lk)("tr",null,[(0,i.Lk)("th",{colspan:"3",class:(0,r.C4)(["bold-text",`depth-${e.depth}`])},(0,r.v_)(e.name),3)]),"배전망 건설 단가"===e.name?((0,i.uX)(),(0,i.CE)("tr",q,[(0,i.Lk)("td",T,[(0,i.bF)(R.$,{modelValue:p.value,"onUpdate:modelValue":a[0]||(a[0]=e=>p.value=e),class:"radio-group","hide-details":""},{default:(0,i.k6)((()=>[(0,i.bF)(A.i,{label:"증축",value:"증축"}),(0,i.bF)(A.i,{label:"신축",value:"신축"})])),_:1},8,["modelValue"])])])):(0,i.Q3)("",!0),"배전망 건설 단가"===e.name?((0,i.uX)(),(0,i.CE)("tr",X,[(0,i.Lk)("td",M,[(0,i.bF)(R.$,{modelValue:k.value,"onUpdate:modelValue":a[1]||(a[1]=e=>k.value=e),class:"radio-group","hide-details":""},{default:(0,i.k6)((()=>[(0,i.bF)(A.i,{label:"AC",value:"AC"}),(0,i.bF)(A.i,{label:"DC",value:"DC"})])),_:1},8,["modelValue"])])])):(0,i.Q3)("",!0),"발전소 구축단가"===e.name?((0,i.uX)(),(0,i.CE)("tr",J,[(0,i.Lk)("td",$,[(0,i.bF)(R.$,{modelValue:h.value,"onUpdate:modelValue":a[2]||(a[2]=e=>h.value=e),class:"radio-group","hide-details":""},{default:(0,i.k6)((()=>[(0,i.bF)(A.i,{label:"기존",value:"기존"}),(0,i.bF)(A.i,{label:"신축",value:"신축"})])),_:1},8,["modelValue"])])])):(0,i.Q3)("",!0),ae(e).length>0?((0,i.uX)(!0),(0,i.CE)(i.FK,{key:3},(0,i.pI)(ae(e),((e,t)=>((0,i.uX)(),(0,i.CE)("tr",{key:t},[(0,i.Lk)("td",B,(0,r.v_)(e.name),1),(0,i.Lk)("td",z,[e.modify?((0,i.uX)(),(0,i.Wv)(O.W,{key:0,modelValue:e.data,"onUpdate:modelValue":t=>e.data=t,dense:"",variant:"plain",type:"number",class:"input-field",onInput:t=>w(e,t)},null,8,["modelValue","onUpdate:modelValue","onInput"])):((0,i.uX)(),(0,i.CE)("span",j,(0,r.v_)(e.data),1))]),(0,i.Lk)("td",U,(0,r.v_)(e.unit),1)])))),128)):((0,i.uX)(),(0,i.CE)("p",Z,"해당 단가 데이터 없음"))],64)):C(e.values)?((0,i.uX)(),(0,i.CE)(i.FK,{key:2},[(0,i.Lk)("tr",null,[(0,i.Lk)("th",Y,(0,r.v_)(e.name),1)]),((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(e.values,((e,t)=>((0,i.uX)(),(0,i.CE)("tr",{key:t},[(0,i.Lk)("td",Q,(0,r.v_)(e.name),1),(0,i.Lk)("td",G,[e.modify?((0,i.uX)(),(0,i.Wv)(O.W,{key:0,modelValue:e.data,"onUpdate:modelValue":t=>e.data=t,dense:"",variant:"plain",type:"number",class:"input-field"},null,8,["modelValue","onUpdate:modelValue"])):((0,i.uX)(),(0,i.CE)("span",H,(0,r.v_)(e.data),1))]),(0,i.Lk)("td",ee,(0,r.v_)(e.unit),1)])))),128))],64)):(0,i.Q3)("",!0)],64)))),128))])])),_:1})):((0,i.uX)(),(0,i.CE)("p",te,"데이터 없음"))])),_:1}),(0,i.bF)(g.S,null,{default:(0,i.k6)((()=>[(0,i.bF)(m.D,{color:"primary",onClick:F},{default:(0,i.k6)((()=>a[5]||(a[5]=[(0,i.eW)("저장")]))),_:1}),(0,i.bF)(m.D,{color:"grey",onClick:_},{default:(0,i.k6)((()=>a[6]||(a[6]=[(0,i.eW)("취소")]))),_:1})])),_:1})])),_:1})])),_:1},8,["modelValue"])):(0,i.Q3)("",!0)}};const ne=(0,I.A)(ae,[["__scopeId","data-v-0460f35c"]]);var le=ne;const oe={class:"app"};var ue={__name:"App",setup(e){const t=(0,s.KR)(!1),a=(0,s.KR)(""),n=(0,s.KR)(""),l=(0,s.KR)(""),o=(e,o,u)=>{a.value=e,n.value=o,l.value=u,t.value=!0},u=()=>{console.log("🔸 다이얼로그 닫기 및 데이터 초기화"),t.value=!1,a.value="",n.value="",l.value=""},r=e=>{console.log("데이터 저장 완료",e)};return(e,s)=>{const d=(0,i.g2)("router-view");return(0,i.uX)(),(0,i.CE)("div",oe,[(0,i.bF)(S),(0,i.bF)(d,{onOpenDialog:o},{default:(0,i.k6)((({Component:e})=>[e?((0,i.uX)(),(0,i.Wv)((0,i.$y)(e),{key:0})):(0,i.Q3)("",!0)])),_:1}),(0,i.bF)(le,{modelValue:t.value,"onUpdate:modelValue":[s[0]||(s[0]=e=>t.value=e),u],id:a.value,uniqueId:n.value,label:l.value,onSaveData:r},null,8,["modelValue","id","uniqueId","label"])])}}};const ie=ue;var se=ie;a(1148),a(8237);const re=(0,u.nY)("itemStore",(()=>{const e=(0,s.KR)([{label:"원전",id:1,setProperty:!0},{label:"석탄화력",id:1,setProperty:!0},{label:"가스복합",id:1,setProperty:!0},{label:"소수력",id:1,setProperty:!0}]),t=(0,s.KR)([{label:"765",id:2,property:[{name:"수요용량",values:[{data:0,unit:"MW",modify:!1}]},{name:"송전설로 건설단가",values:[{data:5700,unit:"백만원/km",modify:!0}]},{name:"여유용량",values:[{data:0,unit:"MW",modify:!0}]},{name:"최대 수용 용량",values:[{data:13,unit:"MW",modify:!0}]}],setProperty:!1},{label:"345",id:3,property:[{name:"수요용량",values:[{data:0,unit:"MW",modify:!1}]},{name:"송전설로 건설단가",values:[{data:2060,unit:"백만원/km",modify:!0}]},{name:"여유용량",values:[{data:0,unit:"MW",modify:!0}]},{name:"최대 수용 용량",values:[{data:13,unit:"MW",modify:!0}]}],setProperty:!1},{label:"154",id:4,property:[{name:"수요용량",values:[{data:0,unit:"MW",modify:!1}]},{name:"송전설로 건설단가",values:[{data:102,unit:"백만원/km",modify:!0}]},{name:"송전 접속단가",values:[{name:"기본 단가",data:667.61,unit:"원/kW",modify:!0},{name:"사용 단가",data:1.42,unit:"원/kWh",modify:!0}]},{name:"송전 손실단가",values:[{name:"원전",data:.03,unit:"원/MWh",modify:!0},{name:"석탄화력",data:.03,unit:"원/MWh",modify:!0},{name:"가스복합",data:-1.39,unit:"원/MWh",modify:!0},{name:"소수력",data:0,unit:"원/MWh",modify:!0}]}],setProperty:!1},{label:"22.9",id:5,property:[{name:"수요용량",values:[{data:30,unit:"MW",modify:!1}]},{name:"여유용량",values:[{data:0,unit:"MW",modify:!0}]},{name:"최대 수용 용량",values:[{data:13,unit:"MW",modify:!0}]},{name:"배전망 건설 단가",values:[{constructionType:"증축",powerType:"AC",costs:[{name:"배전 선로 단가",data:2e3,unit:"만원/km",modify:!0},{name:"전주 공사 단가",data:0,unit:"만원/km",modify:!0},{name:"선로 토체 단가",data:1500,unit:"만원/km",modify:!0},{name:"변압기 단가",data:1e3,unit:"만원/km",modify:!0},{name:"차단기 단가",data:500,unit:"만원/km",modify:!0},{name:"토목 건설 단가",data:0,unit:"만원/km",modify:!0},{name:"운용 비용 단가",data:0,unit:"만원/km",modify:!0},{name:"부대 비용 단가",data:1e3,unit:"만원/km",modify:!0}]},{constructionType:"신축",powerType:"AC",costs:[{name:"배전 선로 단가",data:2e3,unit:"만원/km",modify:!0},{name:"전주 공사 단가",data:2e3,unit:"만원/km",modify:!0},{name:"선로 토체 단가",data:1500,unit:"만원/km",modify:!0},{name:"변압기 단가",data:1e3,unit:"만원/km",modify:!0},{name:"차단기 단가",data:500,unit:"만원/km",modify:!0},{name:"토목 건설 단가",data:1500,unit:"만원/km",modify:!0},{name:"운용 비용 단가",data:1e3,unit:"만원/km",modify:!0},{name:"부대 비용 단가",data:1e3,unit:"만원/km",modify:!0}]},{constructionType:"증축",powerType:"DC",costs:[{name:"배전 선로 단가",data:4e3,unit:"만원/km",modify:!0},{name:"전주 공사 단가",data:0,unit:"만원/km",modify:!0},{name:"선로 토체 단가",data:2500,unit:"만원/km",modify:!0},{name:"변압기 단가",data:2e3,unit:"만원/km",modify:!0},{name:"차단기 단가",data:1e3,unit:"만원/km",modify:!0},{name:"토목 건설 단가",data:0,unit:"만원/km",modify:!0},{name:"운용 비용 단가",data:2e3,unit:"만원/km",modify:!0},{name:"부대 비용 단가",data:2e3,unit:"만원/km",modify:!0}]},{constructionType:"신축",powerType:"DC",costs:[{name:"배전 선로 단가",data:4e3,unit:"만원/km",modify:!0},{name:"전주 공사 단가",data:3e3,unit:"만원/km",modify:!0},{name:"선로 토체 단가",data:2500,unit:"만원/km",modify:!0},{name:"변압기 단가",data:2e3,unit:"만원/km",modify:!0},{name:"차단기 단가",data:1e3,unit:"만원/km",modify:!0},{name:"토목 건설 단가",data:3e3,unit:"만원/km",modify:!0},{name:"운용 비용 단가",data:2e3,unit:"만원/km",modify:!0},{name:"부대 비용 단가",data:2e3,unit:"만원/km",modify:!0}]}]}],setProperty:!1}]),a=(0,s.KR)([{label:"태양광",id:7,property:[{name:"수요용량",values:[{data:0,unit:"MW",modify:!1}]},{name:"계통 유연계수",values:[{data:0,unit:"(0.00~0.10)",modify:!0}]},{name:"여유 용량",values:[{data:0,unit:"MW",modify:!0}]},{name:"발전소 구축단가",values:[{constructionType:"신축",costs:[{name:"건설단가",data:1418,unit:"천원/kW",modify:!0},{name:"유지비용",data:75,unit:"천원/kW",modify:!0},{name:"태양광 거래 단가 (SMP)",data:149,unit:"천원/kWh",modify:!0},{name:"접속비용",data:150,unit:"천원/kW",modify:!0}]},{constructionType:"기존",costs:[{name:"유지비용",data:75,unit:"천원/kW",modify:!0},{name:"태양광 거래 단가 (SMP)",data:149,unit:"천원/kWh",modify:!0},{name:"접속비용",data:150,unit:"천원/kW",modify:!0}]}]}],setProperty:!1},{label:"풍력",id:7,property:[{name:"수요용량",values:[{data:0,unit:"MW",modify:!1}]},{name:"계통 유연계수",values:[{data:0,unit:"(0.00~0.10)",modify:!0}]},{name:"여유 용량",values:[{data:0,unit:"MW",modify:!0}]},{name:"발전소 구축단가",values:[{constructionType:"신축",costs:[{name:"기자재 및 공사비",data:2e3,unit:"천원/kW",modify:!0},{name:"인허가/설계감리",data:150,unit:"천원/kW",modify:!0},{name:"기타 부대비",data:150,unit:"천원/kWh",modify:!0},{name:"유지비용",data:30,unit:"천원/kW",modify:!0},{name:"풍력 거래 단가",data:138,unit:"천원/kW",modify:!0},{name:"접속비용",data:200,unit:"천원/kW",modify:!0}]},{constructionType:"기존",costs:[{name:"유지비용",data:30,unit:"천원/kW",modify:!0},{name:"풍력 거래 단가",data:138,unit:"천원/kWh",modify:!0},{name:"접속비용",data:200,unit:"천원/kW",modify:!0}]}]}],setProperty:!1},{label:"해상풍력",id:7,property:[{name:"수요용량",values:[{data:0,unit:"MW",modify:!1}]},{name:"계통 유연계수",values:[{data:0,unit:"(0.00~0.10)",modify:!0}]},{name:"여유 용량",values:[{data:0,unit:"MW",modify:!0}]},{name:"발전소 구축단가",values:[{constructionType:"신축",costs:[{name:"기자재 및 공사비",data:2928,unit:"천원/kW",modify:!0},{name:"인허가/설계감리",data:732,unit:"천원/kW",modify:!0},{name:"기타 부대비",data:731,unit:"천원/kWh",modify:!0},{name:"유지비용",data:194,unit:"천원/kW",modify:!0},{name:"풍력 거래 단가",data:138,unit:"천원/kW",modify:!0},{name:"접속비용",data:791,unit:"천원/kW",modify:!0}]},{constructionType:"기존",costs:[{name:"유지비용",data:194,unit:"천원/kW",modify:!0},{name:"풍력 거래 단가",data:138,unit:"천원/kWh",modify:!0},{name:"접속비용",data:791,unit:"천원/kW",modify:!0}]}]}],setProperty:!1},{label:"EV",id:7},{label:"EVC",id:7},{label:"ESS",id:7},{label:"DR",id:7},{label:"VPP",id:7}]);return{transStore:e,distribStore:t,nwasStore:a}}));var de=a(7511),ce=a(6756),pe=a(5526);const me={class:"step_container"},ve={class:"itemsArea"},fe={class:"buttons"},ye={class:"buttons"},ge={class:"buttons nwas"},be={class:"text-body-1"},ke={class:"arrangeArea"},he={class:"drop-zones"},we=["onDragover","onDrop"],Ce={class:"list-unstyled m-0 p-0"},_e=["onContextmenu"],Le={class:"content"},Fe=["onClick"],Ie={class:"step-controls"};var Ee={__name:"Step1View",emits:["openDialog"],setup(e,{emit:t}){const a=W(),l=x(),{dropZones:o}=(0,u.bP)(a),p=re(),{transStore:k}=(0,u.bP)(p),{distribStore:h}=(0,u.bP)(p),{nwasStore:w}=(0,u.bP)(p),C=(0,s.KR)(null),_=(0,s.KR)(0),L=c(),F=(0,d.rd)(),I=(0,s.KR)(""),E=(0,s.KR)(""),S=(0,s.KR)("");var A=(0,s.KR)("");const R=(0,s.KR)(!1),N=t,V=(e,t,a)=>{N("openDialog",e,t,a)},K=()=>{new window.daum.Postcode({oncomplete:function(e){I.value=e.address}}).open()},D=(e,t)=>{e.dataTransfer.effectAllowed="move",e.dataTransfer.setData("draggedItem",JSON.stringify(t)),C.value=t},P=(e,t)=>{const n=JSON.parse(e.dataTransfer.getData("draggedItem"));a.addItemToZone(t,n),T(),C.value=null},q=(e,t)=>{if(e.preventDefault(),!C.value)return;const a=t===C.value.id;e.dataTransfer.dropEffect=a?"move":"none",o.value.forEach((e=>{e.isValid=e.id===C.value.id}))},T=()=>{o.value.forEach((e=>e.isValid=!0))};function X(e){e>24&&(A="일별 전력 사용시간은 최대 24시간까지 입력가능합니다.",R.value=!0,S.value=(0,s.KR)(""))}(0,i.wB)([I,E,S],(([e,t,n])=>{e&&t&&n&&a.saveDemandArea(e,t,n)})),(0,i.wB)(o,(e=>{const t=e.filter((e=>2!==e.id)),a=t.every((e=>e.items.length>0));_.value=a?e.reduce(((e,t)=>e*(t.items.length||1)),1):0}),{deep:!0,immediate:!0});const M=(e,t)=>{a.removeItemFromZone(e,t),l.clearTopologyList()},J=()=>{const e=o.value.find((e=>6===e.id)),t=e?.items?.length>0;if(!t)return A="수요지역 위치와 용량을 입력하세요.",R.value=!0,!1;const a=o.value.filter((e=>2!==e.id)),n=a.every((e=>e.items.length>0));return!!n||(A="모든 DropZone에 아이템을 배치해야 합니다. (765 제외)",R.value=!0,!1)},$=()=>{J()?(L.setStepCondition("step1",!0),F.push("/step2"),console.log("step1 DropZones : ",JSON.stringify(o.value))):L.setStepCondition("step1",!1)};return(e,t)=>((0,i.uX)(),(0,i.CE)(i.FK,null,[(0,i.Lk)("div",me,[(0,i.Lk)("div",ve,[(0,i.bF)(ce.L,null,{default:(0,i.k6)((()=>[(0,i.bF)(pe.B,null,{default:(0,i.k6)((()=>[(0,i.bF)(v.J,{class:"demandArea"},{default:(0,i.k6)((()=>[(0,i.bF)(f.r,null,{default:(0,i.k6)((()=>t[5]||(t[5]=[(0,i.eW)("수요지역")]))),_:1}),(0,i.bF)(y.O,null,{default:(0,i.k6)((()=>[(0,i.bF)(O.W,{label:"주소 검색",variant:"outlined",modelValue:I.value,"onUpdate:modelValue":t[0]||(t[0]=e=>I.value=e),placeholder:"주소를 검색하세요",readonly:"","prepend-inner-icon":"mdi-magnify",onClick:K,color:"primary",class:"mb-3","hide-details":""},null,8,["modelValue"]),(0,i.bF)(O.W,{label:"용량",type:"number",variant:"outlined",modelValue:E.value,"onUpdate:modelValue":t[1]||(t[1]=e=>E.value=e),"prepend-inner-icon":"mdi-lightning-bolt",color:"primary",class:"mb-3","hide-details":""},{"append-inner":(0,i.k6)((()=>t[6]||(t[6]=[(0,i.Lk)("span",{class:"text-subtitle-2 pr-2"},"MW",-1)]))),_:1},8,["modelValue"]),(0,i.bF)(O.W,{label:"일별 전력 사용시간",type:"number",variant:"outlined",modelValue:S.value,"onUpdate:modelValue":[t[2]||(t[2]=e=>S.value=e),X],"prepend-inner-icon":"mdi-hours-24",color:"primary"},{"append-inner":(0,i.k6)((()=>t[7]||(t[7]=[(0,i.Lk)("span",{class:"text-subtitle-2 pr-2"},"hr/day",-1)]))),_:1},8,["modelValue"])])),_:1})])),_:1})])),_:1})])),_:1}),(0,i.bF)(ce.L,null,{default:(0,i.k6)((()=>[(0,i.bF)(pe.B,null,{default:(0,i.k6)((()=>[(0,i.bF)(v.J,null,{default:(0,i.k6)((()=>[(0,i.bF)(f.r,null,{default:(0,i.k6)((()=>t[8]||(t[8]=[(0,i.eW)("송배전망")]))),_:1}),(0,i.Lk)("div",fe,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)((0,s.R1)(k),(e=>((0,i.uX)(),(0,i.Wv)(m.D,{class:"round Item",key:e.id,draggable:"true",onDragstart:t=>D(t,e)},{default:(0,i.k6)((()=>[(0,i.eW)((0,r.v_)(e.label),1)])),_:2},1032,["onDragstart"])))),128))]),(0,i.bF)(de.G),(0,i.Lk)("div",ye,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)((0,s.R1)(h),(e=>((0,i.uX)(),(0,i.Wv)(m.D,{class:"round Item",key:e.id,draggable:"true",onDragstart:t=>D(t,e)},{default:(0,i.k6)((()=>[(0,i.eW)((0,r.v_)(e.label),1)])),_:2},1032,["onDragstart"])))),128))])])),_:1})])),_:1})])),_:1}),(0,i.bF)(ce.L,null,{default:(0,i.k6)((()=>[(0,i.bF)(pe.B,null,{default:(0,i.k6)((()=>[(0,i.bF)(v.J,null,{default:(0,i.k6)((()=>[(0,i.bF)(f.r,null,{default:(0,i.k6)((()=>t[9]||(t[9]=[(0,i.eW)("NWAs")]))),_:1}),(0,i.Lk)("div",ge,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)((0,s.R1)(w),(e=>((0,i.uX)(),(0,i.Wv)(m.D,{class:"round Item",key:e.id,draggable:"true",onDragstart:t=>D(t,e)},{default:(0,i.k6)((()=>[(0,i.eW)((0,r.v_)(e.label),1)])),_:2},1032,["onDragstart"])))),128))])])),_:1})])),_:1})])),_:1}),(0,i.bF)(ce.L,null,{default:(0,i.k6)((()=>[(0,i.bF)(pe.B,null,{default:(0,i.k6)((()=>[(0,i.bF)(v.J,{class:"cntTopology"},{default:(0,i.k6)((()=>[(0,i.bF)(f.r,null,{default:(0,i.k6)((()=>t[10]||(t[10]=[(0,i.eW)("Topology")]))),_:1}),(0,i.bF)(y.O,{class:"mt-3"},{default:(0,i.k6)((()=>[(0,i.Lk)("p",be,[t[11]||(t[11]=(0,i.Lk)("strong",null,"최대구성 :",-1)),(0,i.eW)(" "+(0,r.v_)(_.value)+" 개 ",1)])])),_:1})])),_:1})])),_:1})])),_:1})]),(0,i.Lk)("div",ke,[(0,i.Lk)("div",he,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)((0,s.R1)(o),(e=>((0,i.uX)(),(0,i.CE)("div",{key:e.id,class:(0,r.C4)(["drop-zone",{"invalid-zone":!e.isValid}]),onDragover:t=>q(t,e.id),onDragleave:T,onDrop:t=>P(t,e.id)},[(0,i.Lk)("h3",null,(0,r.v_)(e.name),1),(0,i.Lk)("ul",Ce,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(e.items,(t=>((0,i.uX)(),(0,i.CE)("li",{key:t.id},[(0,i.Lk)("div",{class:"round Item",onContextmenu:(0,n.D$)((a=>M(e.id,t.uniqueId)),["prevent"])},[(0,i.Lk)("div",{class:(0,r.C4)(["header",{"blue-header":t.setProperty}])},(0,r.v_)(t.label),3),(0,i.Lk)("div",Le,[(0,i.Lk)("button",{class:(0,r.C4)(["childButton",{"gray-button":1===t.id}]),onClick:e=>V(t.id,t.uniqueId,t.label)}," 세부설정 ",10,Fe)])],40,_e)])))),128))])],42,we)))),128))]),(0,i.Lk)("div",Ie,[(0,i.bF)(m.D,{class:"step-button",onClick:$},{default:(0,i.k6)((()=>t[12]||(t[12]=[(0,i.eW)(" 확인 ")]))),_:1})])])]),(0,i.bF)(b.p,{modelValue:R.value,"onUpdate:modelValue":t[4]||(t[4]=e=>R.value=e),"max-width":"400px"},{default:(0,i.k6)((()=>[(0,i.bF)(v.J,null,{default:(0,i.k6)((()=>[(0,i.bF)(f.r,null,{default:(0,i.k6)((()=>t[13]||(t[13]=[(0,i.eW)(" 경고 ")]))),_:1}),(0,i.bF)(y.O,null,{default:(0,i.k6)((()=>[(0,i.eW)((0,r.v_)((0,s.R1)(A)),1)])),_:1}),(0,i.bF)(g.S,null,{default:(0,i.k6)((()=>[(0,i.bF)(m.D,{color:"primary",onClick:t[3]||(t[3]=e=>R.value=!1)},{default:(0,i.k6)((()=>t[14]||(t[14]=[(0,i.eW)("닫기")]))),_:1})])),_:1})])),_:1})])),_:1},8,["modelValue"])],64))}};const Se=(0,I.A)(Ee,[["__scopeId","data-v-15ea0126"]]);var We=Se,xe=(a(4979),a(1678),a(9669));const Ae={class:"step_container"},Re={class:"listArea"},Ne={class:"text-body-1"},Oe={class:"text-body-1"},Ve={key:0},Ke={class:"topology-ul"},De=["onDragstart","onDrop"],Pe={class:"topology-info"},qe={key:0},Te={class:"topology-actions"},Xe={key:1,class:"text-body-1"},Me={class:"arrangeArea"},Je={class:"title"},$e={class:"guide-message"},Be={class:"drop-zones"},ze=["data-id"],je={class:"list-unstyled m-0 p-0"},Ue=["onClick"],Ze={class:"content"},Ye=["onClick"],Qe={class:"step-controls"},Ge={class:"connection-svg"},He=["x1","y1","x2","y2"],et=["x1","y1","x2","y2"],tt="var(--item-header-bgcolor)",at="var(--item-header-textcolor)";var nt={__name:"Step2View",emits:["openDialog"],setup(e,{emit:t}){const a=W(),l=x(),o=c(),p=(0,d.rd)(),{dropZones:k}=(0,u.bP)(a),{topologyList:h}=(0,u.bP)(l),w=(0,s.KR)([]),C=(0,s.KR)([]),_=(0,s.KR)([]),L=[1,2,3,4,5,6,7];let F=(0,s.KR)(0);const I=(0,s.KR)([]);var E=(0,s.KR)("");const S=(0,s.KR)(!1),A=(0,s.KR)(0),R=(0,i.EW)((()=>l.topologyList.length)),N=["red","orange","yellow","green","blue","indigo","violet"],O=["white","white","black","white","white","white","white"],V=t,K=(e,t,a)=>{V("openDialog",e,t,a)};(0,i.wB)((()=>k.value.map((e=>e.items.map((e=>e.setProperty))))),(()=>{(0,i.dY)((()=>{D()}))}),{deep:!0}),(0,i.wB)((()=>l.topologyList.flat().map((e=>`${e.uniqueId}:${e.setProperty}`)).join("|")),(()=>{console.log("📦 상태 변경 감지됨!")}));const D=()=>{k.value.forEach((e=>{e.items.forEach((e=>{const t=document.querySelector(`.header-${e.uniqueId}`);t&&(e.setProperty?t.style.backgroundColor="#0056b3":(t.style.backgroundColor=tt,t.style.color=at))}))}))},P=e=>{"Escape"===e.key&&(_.value=[],w.value=[],F.value=0,I.value=[],D()),"finish"===e&&(w.value=[],F.value=0,I.value=[],D()),D()},q=()=>{const e=k.value.filter((e=>2!==e.id)),t=e.every((e=>e.items.length>0));A.value=t?k.value.reduce(((e,t)=>e*(t.items.length||1)),1):0};(0,i.sV)((()=>{window.addEventListener("keydown",P),q(),console.log("Step2 mount!",l.topologyList)})),(0,d.JZ)((()=>{})),(0,i.hi)((()=>{window.removeEventListener("keydown",P)}));const T=(e,t,a,n)=>{const o=e.currentTarget;console.log("click",o);const u=o.getBoundingClientRect();if(0===w.value.length&&1!==a)return E="발전소부터 클릭하세요!",S.value=!0,void M(a);if(1===a&&l.isNotAdd())return E="더이상 리스트를 추가할 수 없습니다.",void(S.value=!0);const i=k.value.find((e=>2===e.id)),s=i&&i.items.length>0,r=L[F.value-1],d=!s&&1===r&&3===a,c=[4,7].includes(a),p=L[F.value]===a,m=c&&w.value.some((e=>e.zoneId===a)),v=w.value.length>0?w.value[w.value.length-1].zoneId:null,f=(p||d||m)&&!(5===v&&6!==a);if(!f)return E="순서대로 입력하세요!",S.value=!0,void M(a);{const e=u.left+u.width/2,i=u.top+u.height/2;if(w.value.some((e=>e.id===t))&&!c||w.value.push({id:t,zoneId:a,x:e,y:i}),w.value.length>1){const e=w.value.length-1;_.value.push({x1:w.value[e-1].x,y1:w.value[e-1].y,x2:w.value[e].x,y2:w.value[e].y})}I.value.includes(n)||I.value.push(n),o.querySelector(".header").style.backgroundColor=N[l.topologyList.length],o.querySelector(".header").style.color=O[l.topologyList.length],(!c||c&&!m)&&(d?F.value+=2:F.value++),console.log(F.value)}},X=()=>{I.value.length>0&&7===I.value[I.value.length-1].id?(E="마지막까지 잘 연결",S.value=!0,C.value.push(..._.value),_.value=[],l.addTopology([...I.value]),P("finish")):(E="마지막 NWAs 까지 연결하세요!",S.value=!0),console.log("step2 : dropZones",JSON.stringify(k.value)),console.log("step2 : topologyStore",JSON.stringify(l.topologyList)),k.value=structuredClone(k.value)},M=e=>{const t=document.querySelector(`.drop-zone[data-id="${e}"]`);t?(t.classList.add("error-zone"),setTimeout((()=>{t.classList.remove("error-zone")}),1e3)):console.error(`존재하지 않는 zoneId: ${e}`)},J=()=>{const e=k.value.find((e=>e.id===L[F.value]));return e?e.name:"완료"},$=(0,i.EW)((()=>L[F.value])),B=(0,s.KR)(null),z=e=>{B.value=e},j=e=>{if(null===B.value)return;const t=x(),a=[...t.topologyList],n=a.splice(B.value,1)[0];a.splice(e,0,n),t.setTopologyList(a),B.value=null},U=e=>{const t=x();t.removeTopology(e)},Z=()=>{Y()?(o.setStepCondition("step2",!0),p.push("/step3")):o.setStepCondition("step2",!1)},Y=()=>{if(console.log("step2 : dropZones",JSON.stringify(k.value)),console.log("step2 : topologyStore",JSON.stringify(l.topologyList)),l.topologyList.length<2)return E="2개 이상의 List를 생성하세요!",S.value=!0,!1;const e=l.topologyList.every((e=>e.every((e=>e.setProperty))));return l.topologyList.forEach(((e,t)=>{e.forEach((e=>{e.setProperty||(console.warn(`❌ Group ${t}, Node ${e.label} (ID: ${e.id}) 는 아직 설정 안됨`),console.log(JSON.stringify(e)))}))})),console.log(JSON.stringify(k)),!!e||(E="모든 아이템에 세부값을 수정하세요",S.value=!0,!1)};return(e,t)=>((0,i.uX)(),(0,i.CE)("div",Ae,[(0,i.Lk)("div",Re,[(0,i.bF)(ce.L,null,{default:(0,i.k6)((()=>[(0,i.bF)(pe.B,{class:"topology"},{default:(0,i.k6)((()=>[(0,i.bF)(v.J,null,{default:(0,i.k6)((()=>[(0,i.bF)(f.r,null,{default:(0,i.k6)((()=>t[3]||(t[3]=[(0,i.eW)("Topology")]))),_:1}),(0,i.bF)(y.O,{class:"mt-3"},{default:(0,i.k6)((()=>[(0,i.Lk)("p",Ne,[t[4]||(t[4]=(0,i.Lk)("strong",null,"최대구성 :",-1)),(0,i.eW)(" "+(0,r.v_)(A.value)+" 개 ",1)]),(0,i.Lk)("p",Oe,[t[5]||(t[5]=(0,i.Lk)("strong",null,"비교군 :",-1)),(0,i.eW)(" "+(0,r.v_)(R.value)+" 개 ",1)])])),_:1})])),_:1})])),_:1}),(0,i.bF)(pe.B,{class:"topologyList"},{default:(0,i.k6)((()=>[(0,i.bF)(v.J,null,{default:(0,i.k6)((()=>[(0,i.bF)(f.r,{class:"d-flex justify-space-between align-center"},{default:(0,i.k6)((()=>t[6]||(t[6]=[(0,i.eW)(" TopologyList ")]))),_:1}),(0,i.bF)(y.O,{class:"text-body-1"},{default:(0,i.k6)((()=>[(0,s.R1)(h).length>0?((0,i.uX)(),(0,i.CE)("div",Ve,[(0,i.Lk)("ul",Ke,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)((0,s.R1)(h),((e,a)=>((0,i.uX)(),(0,i.CE)("li",{key:a,class:"topology-item",draggable:"true",onDragstart:e=>z(a),onDragover:t[0]||(t[0]=(0,n.D$)((()=>{}),["prevent"])),onDrop:e=>j(a)},[(0,i.Lk)("div",Pe,[(0,i.bF)(xe.w,{class:"drag-handle"},{default:(0,i.k6)((()=>t[7]||(t[7]=[(0,i.eW)("mdi-drag")]))),_:1}),(0,i.Lk)("span",{style:(0,r.Tr)({display:"inline-block",padding:"3px 15px",marginRight:"10px",borderRadius:"5px",fontSize:"12px",fontWeight:"bold",color:O[a%O.length],backgroundColor:N[a%N.length]})},"List "+(0,r.v_)(a+1)+". ",5),((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(e||[],((t,a)=>((0,i.uX)(),(0,i.CE)("p",{key:t.uniqueId||a},[(0,i.eW)((0,r.v_)(t.label)+" ",1),a<e.length-1?((0,i.uX)(),(0,i.CE)("span",qe," > ")):(0,i.Q3)("",!0)])))),128))]),(0,i.Lk)("div",Te,[(0,i.bF)(m.D,{color:"red",icon:"",onClick:e=>U(a)},{default:(0,i.k6)((()=>[(0,i.bF)(xe.w,{size:"xs"},{default:(0,i.k6)((()=>t[8]||(t[8]=[(0,i.eW)("mdi-delete")]))),_:1})])),_:2},1032,["onClick"])])],40,De)))),128))])])):((0,i.uX)(),(0,i.CE)("p",Xe,"저장된 Topology가 없습니다."))])),_:1})])),_:1})])),_:1})])),_:1})]),(0,i.Lk)("div",Me,[(0,i.Lk)("div",Je,[(0,i.Lk)("p",$e,[t[9]||(t[9]=(0,i.eW)(" 선택 영역 : ")),(0,i.Lk)("strong",null,(0,r.v_)(J()),1)]),(0,i.bF)(m.D,{class:"addList",onClick:X,color:"primary"},{default:(0,i.k6)((()=>t[10]||(t[10]=[(0,i.eW)(" 추가 ")]))),_:1})]),(0,i.Lk)("div",Be,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)((0,s.R1)(k),(e=>((0,i.uX)(),(0,i.CE)("div",{key:e.id,class:(0,r.C4)(["drop-zone",{"invalid-zone":!e.isValid,"active-zone":e.id===$.value}]),"data-id":e.id},[(0,i.Lk)("h3",null,(0,r.v_)(e.name),1),(0,i.Lk)("ul",je,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(e.items,(t=>((0,i.uX)(),(0,i.CE)("li",{key:t.uniqueId||t.id},[(0,i.Lk)("div",{class:(0,r.C4)(["round Item",{"next-clickable":e.id===$.value}]),ref_for:!0,ref:"buttons",onClick:a=>T(a,t.id,e.id,t)},[(0,i.Lk)("div",{class:(0,r.C4)(["header",[{"blue-header":t.setProperty},`header-${t.uniqueId}`]])},(0,r.v_)(t.label),3),(0,i.Lk)("div",Ze,[(0,i.Lk)("button",{class:(0,r.C4)(["childButton",{"gray-button":1===t.id}]),onClick:(0,n.D$)((e=>K(t.id,t.uniqueId,t.label)),["stop"])}," 세부설정 ",10,Ye)])],10,Ue)])))),128))])],10,ze)))),128))]),(0,i.Lk)("div",Qe,[(0,i.bF)(m.D,{class:"step-button",onClick:Z},{default:(0,i.k6)((()=>t[11]||(t[11]=[(0,i.eW)(" 확인 ")]))),_:1})])]),((0,i.uX)(),(0,i.CE)("svg",Ge,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(_.value,((e,t)=>((0,i.uX)(),(0,i.CE)("line",{key:"pending-"+t,x1:e.x1,y1:e.y1,x2:e.x2,y2:e.y2,stroke:"black","stroke-width":"2","stroke-dasharray":"0"},null,8,He)))),128)),((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(C.value,((e,t)=>((0,i.uX)(),(0,i.CE)("line",{key:"completed-"+t,x1:e.x1,y1:e.y1,x2:e.x2,y2:e.y2,stroke:"black","stroke-width":"2","stroke-dasharray":"5,5"},null,8,et)))),128))])),(0,i.bF)(b.p,{modelValue:S.value,"onUpdate:modelValue":t[2]||(t[2]=e=>S.value=e),"max-width":"400px"},{default:(0,i.k6)((()=>[(0,i.bF)(v.J,null,{default:(0,i.k6)((()=>[(0,i.bF)(f.r,null,{default:(0,i.k6)((()=>t[12]||(t[12]=[(0,i.eW)(" 경고 ")]))),_:1}),(0,i.bF)(y.O,null,{default:(0,i.k6)((()=>[(0,i.eW)((0,r.v_)((0,s.R1)(E)),1)])),_:1}),(0,i.bF)(g.S,null,{default:(0,i.k6)((()=>[(0,i.bF)(m.D,{color:"primary",onClick:t[1]||(t[1]=e=>S.value=!1)},{default:(0,i.k6)((()=>t[13]||(t[13]=[(0,i.eW)("닫기")]))),_:1})])),_:1})])),_:1})])),_:1},8,["modelValue"])]))}};const lt=(0,I.A)(nt,[["__scopeId","data-v-7bdfaa2b"]]);var ot=lt,ut=(a(7642),a(8004),a(3853),a(5876),a(2475),a(5024),a(1698),a(3813));const it={class:"step_container"},st={class:"topologyList"},rt=["onClick"],dt={class:"zone-title"},ct={class:"vertical-layout"},pt=["onClick","data-zone-index","data-node-id","disabled"],mt={class:"step-controls"},vt={class:"connection-svg"},ft=["x1","y1","x2","y2","stroke"];var yt={__name:"Step3View",setup(e){const t=x(),a=c(),n=(0,d.rd)(),{topologyList:l}=(0,u.bP)(t),o=(0,s.KR)([]),p=(0,s.KR)([]),k=(0,s.KR)(0),h=(0,s.KR)(null),w=(0,s.KR)(new Set),C=(0,s.KR)(new Set);let _,L=[];var F=(0,s.KR)("");const I=(0,s.KR)(!1),E=[{id:7,name:"NWAs"},{id:6,name:"수요지역"},{id:5,name:"22.9"},{id:4,name:"154"},{id:3,name:"345"},{id:2,name:"765"},{id:1,name:"발전소"}],S=["red","orange","yellow","green","blue","indigo","violet"],W=["white","white","black","white","white","white","white"];(0,i.sV)((()=>{(0,i.dY)((()=>{N()}));const e=setInterval((()=>{window.google&&window.google.maps&&(clearInterval(e),window.initMap())}),100);let t=!1;l.value.forEach((e=>{e.forEach((e=>{t||2!==e.id||(h.value=e.uniqueId,t=!0)}))})),t||l.value.forEach((e=>{e.forEach((e=>{3===e.id&&(h.value=e.uniqueId)}))}))}));const A=e=>w.value.has(e.uniqueId),R=(0,i.EW)((()=>{const e=new Map(E.map((({id:e,name:t})=>[e,{name:t,nodes:[]}]))),t=new Set;return l.value.forEach((a=>{a.forEach((a=>{if(t.has(a.uniqueId))return;t.add(a.uniqueId);const n=e.get(a.id)||e.get(7);n.nodes.push(a)}))})),E.map((({id:t})=>e.get(t)))})),N=async()=>{p.value=[],await(0,i.dY)(),requestAnimationFrame((()=>{if(o.value=Array.from(document.querySelectorAll(".node-button")),0===o.value.length)return;const e=new Map;o.value.forEach((t=>{const a=t.getAttribute("data-zone-index"),n=t.getAttribute("data-node-id");a&&n&&e.set(`${a}-${n}`,t)})),l.value.forEach(((t,a)=>{t.forEach(((n,l)=>{if(l===t.length-1)return;const o=t[l+1],u=R.value.findIndex((e=>e.nodes.some((e=>e.uniqueId===n.uniqueId)))),i=R.value.findIndex((e=>e.nodes.some((e=>e.uniqueId===o.uniqueId))));if(-1===u||-1===i)return;const s=e.get(`${u}-${n.uniqueId}`),r=e.get(`${i}-${o.uniqueId}`);if(!s||!r)return;const d=s.getBoundingClientRect(),c=r.getBoundingClientRect();p.value.push({x1:d.left+d.width/2,y1:d.top+d.height/2+window.scrollY,x2:c.left+c.width/2,y2:c.top+c.height/2+window.scrollY,startNodeId:n.uniqueId,endNodeId:o.uniqueId,listIndex:a})}))}))}))},O=e=>{k.value=e,w.value.clear(),C.value.clear(),B.value=null,l.value[e]&&(l.value[e].forEach((e=>{w.value.add(e.uniqueId)})),p.value.forEach(((t,a)=>{t.listIndex===e&&C.value.add(a)}))),J.forEach((t=>{const a=l.value[e].find((e=>e.uniqueId===t.btnId));a?t.setIcon({...q(S[e%S.length]),anchor:new window.google.maps.Point(12,22),scaledSize:new window.google.maps.Size(24,24)}):t.setIcon({...q("#808080"),anchor:new window.google.maps.Point(12,22),scaledSize:new window.google.maps.Size(24,24)})})),U(),Z()},V=(0,i.EW)((()=>p.value.map(((e,t)=>C.value.has(t)?S[e.listIndex%S.length]:"gray")))),K=()=>new Promise(((e,t)=>{if(window.google&&window.google.maps)return void e();const a=document.createElement("script");a.src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBXEVH1qv_P54Ew7f7uiYtdK0YQ7h3c3Yg&libraries=geometry,places",a.async=!0,a.defer=!0,a.onload=()=>{e()},a.onerror=e=>{t(e)},document.head.appendChild(a)})),D=()=>{if(!Array.isArray(l.value))return null;const e=l.value.flat();for(const t of e)if("수요지역"===t.label)return t;return null};let P;window.initMap=async()=>{await K(),P=class extends(window.google?.maps?.OverlayView||class{}){constructor(e,t,a){if(super(),!window.google||!window.google.maps)throw new Error("Google Maps API가 로드되지 않았습니다.");this.position=e,this.id=a,this.containerDiv=document.createElement("div"),this.containerDiv.className="custom-popup",this.containerDiv.style.position="absolute",this.containerDiv.style.display="none",this.containerDiv.style.transform="translate(-50%, -150%)",this.containerDiv.style.backgroundColor="white",this.containerDiv.style.boxShadow="0px 2px 10px rgba(0,0,0,0.3)",this.containerDiv.style.borderRadius="8px",this.containerDiv.style.whiteSpace="nowrap",this.containerDiv.innerHTML=`\n      <div class="custom-popup-header" style="font-weight: bold; display: flex; justify-content: space-between; align-items: center;">\n        📍 ${t.title}\n        <span class="custom-popup-close" style="cursor: pointer;">&times;</span>\n      </div>\n      <div class="custom-popup-body" style="margin-top: 5px;">${t.body}</div>\n    `;const n=this.containerDiv.querySelector(".custom-popup-close");n?.addEventListener("click",(()=>{this.hide()}))}onAdd(){this.getPanes().floatPane.appendChild(this.containerDiv),this.show()}draw(){const e=this.getProjection();if(!e)return;const t=e.fromLatLngToDivPixel(this.position);t&&(this.containerDiv.style.left=`${t.x}px`,this.containerDiv.style.top=t.y-15+"px")}onRemove(){this.containerDiv.parentElement&&this.containerDiv.parentElement.removeChild(this.containerDiv)}show(){this.containerDiv.style.display="block"}hide(){this.containerDiv.style.display="none"}};const e=D();if(!e)return;const t=e.property?.find((e=>"주소"===e.name)),a=t?.values?.[0]?.data||null,n=await T(a),l=document.getElementById("map");if(!l)return;_=new window.google.maps.Map(l,{zoom:3,mapTypeId:"hybrid",styles:[{elementType:"labels.icon",stylers:[{visibility:"off"}]},{elementType:"labels.text.fill",stylers:[{color:"#ffffff"}]},{elementType:"labels.text.stroke",stylers:[{color:"#000000"}]}]});const o=new window.google.maps.LatLngBounds;o.extend(n),_.fitBounds(o),X(e.uniqueId,o.getCenter().lat(),o.getCenter().lng()),window.google.maps.event.addListenerOnce(_,"bounds_changed",(()=>{_.setZoom(12)}));const u=new window.google.maps.Marker({position:o.getCenter(),map:_,icon:{...q("#f00"),anchor:new window.google.maps.Point(12,22),scaledSize:new window.google.maps.Size(24,24)}}),i=new P(o.getCenter(),{title:"수요지역",body:`\n      위도: ${o.getCenter().lat()}<br>\n      경도: ${o.getCenter().lng()}\n    `});i.setMap(_),u.addListener("click",(()=>{i.show()})),i.show(),_.addListener("click",(e=>{j(e.latLng)}))};const q=e=>({path:"M12,11.5A2.5,2.5 0 0,1 9.5,9A2.5,2.5 0 0,1 12,6.5A2.5,2.5 0 0,1 14.5,9A2.5,2.5 0 0,1 12,11.5M12,2A7,7 0 0,0 5,9C5,14.25 12,22 12,22C12,22 19,14.25 19,9A7,7 0 0,0 12,2Z",fillColor:e,fillOpacity:1,strokeWeight:1,strokeColor:"#FFFFFF",scale:2}),T=e=>new Promise(((t,a)=>{let n=new window.google.maps.Geocoder;n.geocode({address:e},((e,n)=>{if("OK"===n&&e[0]){const a=e[0].geometry.location;t({lat:a.lat(),lng:a.lng()})}else a(n)}))})),X=(e,t,a)=>{Array.isArray(l.value)&&(l.value=l.value.map((n=>n.map((n=>n.uniqueId===e?{...n,lat:t,lng:a}:n)))))},M=(0,s.KR)(null);let J=[],$=[];const B=(0,s.KR)(null),z=(e,t,a)=>{B.value={uniqueId:e,label:t,id:a}},j=e=>{if(null===B.value)return;const t={lat:e.lat(),lng:e.lng()},a=l.value.findIndex((e=>e.some((e=>e.uniqueId===B.value.uniqueId))));if(-1===a)return void console.error("❌ 선택된 버튼의 리스트를 찾을 수 없습니다.");const n=null!==k.value?S[k.value%S.length]:S[a%S.length];if(l.value=l.value.map((e=>e.map((e=>e.uniqueId===B.value.uniqueId?{...e,lat:t.lat,lng:t.lng}:e)))),1===B.value.id){const e=l.value.flat(),a=e.findIndex((e=>e.uniqueId===B.value.uniqueId)),n=e[a+1];n?(console.log("nextNode 좌표 업데이트",n.label),l.value.forEach((e=>{e.forEach((e=>{e.uniqueId===n.uniqueId&&(e.lat=t.lat,e.lng=t.lng)}))})),h.value=n.uniqueId):console.log("nextNode 없음")}let o=!1;if(J.forEach((e=>{e.btnId===B.value.uniqueId&&(e.setIcon({...q(n),anchor:new window.google.maps.Point(12,22),scaledSize:new window.google.maps.Size(24,24)}),e.setPosition(t),o=!0)})),!o){const e=new window.google.maps.Marker({position:t,map:_,title:`Marker for ${B.value.uniqueId}`,icon:{...q(n),anchor:new window.google.maps.Point(12,22),scaledSize:new window.google.maps.Size(24,24)}});e.btnId=B.value.uniqueId,J.push(e)}$=$.filter((e=>e.btnId!==B.value.uniqueId||(e.setMap(null),!1)));const u=new P(t,{title:B.value.label,id:B.value.uniqueId,body:`\n      위도: ${t.lat}<br>\n      경도: ${t.lng}\n    `});u.btnId=B.value.uniqueId,u.setMap(_),$.push(u),J.forEach((e=>{e.addListener("click",(()=>{$.forEach((t=>{t.btnId===e.btnId?t.show():t.hide()}))}))})),Z(),U(),console.log(l.value)},U=()=>{if(!_)return void console.error("❌ 지도(map)가 아직 초기화되지 않았습니다.");if(L.forEach((e=>e.setMap(null))),L=[],null===k.value)return;const e=l.value[k.value];if(!e)return;let t=[];if(e.forEach((e=>{Number.isFinite(e.lat)&&Number.isFinite(e.lng)&&0!==e.lat&&0!==e.lng&&t.push({lat:e.lat,lng:e.lng}),l.value.forEach((a=>{a.forEach((a=>{a.uniqueId===e.uniqueId&&Number.isFinite(a.lat)&&Number.isFinite(a.lng)&&0!==a.lat&&0!==a.lng&&t.push({lat:a.lat,lng:a.lng})}))}))})),t=Array.from(new Set(t.map(JSON.stringify))).map(JSON.parse),t.length>1){const e=S[k.value%S.length],a=new window.google.maps.Polyline({path:t,geodesic:!0,strokeColor:e,strokeOpacity:1,strokeWeight:3});a.setMap(_),L.push(a)}},Z=()=>{if(!_)return void console.error("❌ 지도(map)가 아직 초기화되지 않았습니다.");if(null===k.value)return;const e=l.value[k.value];e&&$.forEach((t=>{const a=e.find((e=>e.uniqueId===t.btnId));a?t.setMap(_):t.setMap(null)}))},Y=()=>{Q(l.value)?(a.setStepCondition("step3",!0),n.push("/step4")):(F="모든 아이템의 좌표를 입력하세요!",I.value=!0,a.setStepCondition("step3",!1)),console.log(JSON.stringify(l.value))},Q=e=>e.every((e=>e.every((e=>0!==e.lat&&0!==e.lng))));return(e,t)=>((0,i.uX)(),(0,i.CE)("div",it,[(0,i.bF)(ut.I,{class:"treeArea"},{default:(0,i.k6)((()=>[(0,i.Lk)("div",st,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)((0,s.R1)(l),((e,t)=>((0,i.uX)(),(0,i.CE)("span",{key:t,onClick:e=>O(t),style:(0,r.Tr)({display:"inline-block",padding:"3px 15px",marginRight:"10px",borderRadius:"5px",fontSize:"12px",fontWeight:"bold",cursor:"pointer",border:k.value===t?`2px solid ${S[t%S.length]}`:"none",color:W[t%W.length],backgroundColor:S[t%S.length]})}," List "+(0,r.v_)(t+1),13,rt)))),128))]),((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(R.value,((e,t)=>((0,i.uX)(),(0,i.CE)("div",{key:t,class:"zone-column"},[(0,i.Lk)("p",dt,(0,r.v_)(e.name),1),(0,i.Lk)("div",ct,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(e.nodes,(e=>((0,i.uX)(),(0,i.CE)("button",{key:e.uniqueId,class:(0,r.C4)(["node-button",{"node-disabled":"수요지역"===e.label||e.uniqueId===h.value,"node-selected":A(e),"node-active":A(e)&&0!==e.lat&&0!==e.lng}]),onClick:t=>A(e)&&"수요지역"!==e.label?z(e.uniqueId,e.label,e.id):null,"data-zone-index":t,"data-node-id":e.uniqueId,style:(0,r.Tr)({backgroundColor:A(e)?0!==e.lat&&0!==e.lng?S[k.value%S.length]:"#2C3E50":"#808080",color:A(e)?0!==e.lat&&0!==e.lng?W[k.value%S.length]:"#fff":"#000",opacity:A(e)?1:.4}),disabled:!A(e)||"수요지역"===e.label},(0,r.v_)(e.label),15,pt)))),128))])])))),128)),(0,i.Lk)("div",mt,[(0,i.bF)(m.D,{class:"step-button",onClick:Y},{default:(0,i.k6)((()=>t[2]||(t[2]=[(0,i.eW)(" 확인 ")]))),_:1})])])),_:1}),((0,i.uX)(),(0,i.CE)("svg",vt,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(p.value,((e,t)=>((0,i.uX)(),(0,i.CE)("line",{key:t,x1:e.x1,y1:e.y1,x2:e.x2,y2:e.y2,stroke:V.value[t],"stroke-width":"2",class:(0,r.C4)({"highlighted-line":C.value.has(t),"dimmed-line":!C.value.has(t)})},null,10,ft)))),128))])),(0,i.Lk)("div",{class:"mapArea",id:"map",ref_key:"mapRef",ref:M},null,512),(0,i.bF)(b.p,{modelValue:I.value,"onUpdate:modelValue":t[1]||(t[1]=e=>I.value=e),"max-width":"400px"},{default:(0,i.k6)((()=>[(0,i.bF)(v.J,null,{default:(0,i.k6)((()=>[(0,i.bF)(f.r,null,{default:(0,i.k6)((()=>t[3]||(t[3]=[(0,i.eW)(" 경고 ")]))),_:1}),(0,i.bF)(y.O,null,{default:(0,i.k6)((()=>[(0,i.eW)((0,r.v_)((0,s.R1)(F)),1)])),_:1}),(0,i.bF)(g.S,null,{default:(0,i.k6)((()=>[(0,i.bF)(m.D,{color:"primary",onClick:t[0]||(t[0]=e=>I.value=!1)},{default:(0,i.k6)((()=>t[4]||(t[4]=[(0,i.eW)("닫기")]))),_:1})])),_:1})])),_:1})])),_:1},8,["modelValue"])]))}};const gt=(0,I.A)(yt,[["__scopeId","data-v-e1fea858"]]);var bt=gt,kt=a(2328),ht=a.n(kt),wt=a(3571),Ct=a(1578),_t=a(5608),Lt=a(4242),Ft=a(6686),It=a(6048),Et=a(1781);const St={class:"step-container"},Wt={class:"export-plot"},xt={class:"export-bar"},At={class:"export-doughnut"};var Rt={__name:"Step4View",setup(e){const t=x(),{topologyList:a}=(0,u.bP)(t),n=e=>e.map((e=>{const t={},a=e.find((e=>"154"===e.label));if(a?.property){const e=a.property.find((e=>"송전 손실단가"===e.name));e?.values&&e.values.forEach((e=>{e.name&&void 0!==e.data&&(t[e.name]=e.data)}))}const n=e.map((e=>{const a=e.label,n="수요지역"!==a?a.replace(/-[A-Z]$/i,""):a,l=e.property??[],o={};return l.forEach((e=>{const t=e.name,a=e.values;t&&Array.isArray(a)&&(1===a.length&&"data"in a[0]?o[t]=a[0].data:a.every((e=>"name"in e&&"data"in e))?o[t]=a.reduce(((e,t)=>(e[t.name]=t.data,e)),{}):["배전망 건설 단가","태양광 발전소 구축단가"].includes(t)?o[t]=a.map((e=>({...e.constructionType&&{constructionType:e.constructionType},...e.powerType&&{powerType:e.powerType},costs:Array.isArray(e.costs)?e.costs.reduce(((e,t)=>(e[t.name]=t.data,e)),{}):{}}))):o[t]=a)})),void 0!==t[a]&&(o["손실단가"]=t[a]),o["lat"]=e.lat??0,o["lng"]=e.lng??0,[n,o]}));return new Map(n)})),l=n(a.value),o=(0,s.KR)("cost"),d=(0,s.KR)(null),c=(0,s.KR)(null),p=(0,s.KR)(null),f=(0,s.KR)(null);let y=null,g=null,b=null,k=null;const h=(0,s.KR)([]),w=(0,s.KR)(null),C=(0,s.KR)([]),_=(0,s.KR)([{}]),L=(0,s.KR)({labels:[],datasets:[{label:"NWAs 편익 비용",data:[],backgroundColor:[],borderWidth:1}]}),F=(0,s.KR)(0),I=(0,i.EW)((()=>a.value.map(((e,t)=>({title:`경로 ${t+1}`,value:t}))))),E=()=>{const e=l[F.value];if(!e)return;const t=W(e);_.value=t.bar,L.value=t.doughnut,h.value=t.table},S=async()=>{if(await(0,i.dY)(),D(),d.value)try{y=new wt.Ay(d.value.getContext("2d"),{type:"bar",data:_.value,options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!0},tooltip:{callbacks:{label:function(e){const t=e.parsed.y||0;return e.dataset.label+": "+(t/1e6).toLocaleString()+" 백만 원"}}}},scales:{y:{beginAtZero:!0,title:{display:!0,text:"비용 (백만원)"},ticks:{callback:function(e){return(e/1e6).toLocaleString()+"백만"}}}}}})}catch(e){console.error("chart생성 오류")}c.value&&(g=new wt.Ay(c.value.getContext("2d"),{type:"doughnut",data:L.value,options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"top"},tooltip:{callbacks:{label:function(e){const t=e.raw,a=e.dataset.data.reduce(((e,t)=>e+t),0),n=(t/a*100).toFixed(2),l=(t/1e6).toLocaleString();return`${e.label}: ${l} 백만 원 (${n}%)`}}}}},plugins:[T]})),p.value&&(b=new wt.Ay(p.value.getContext("2d"),{type:"line",data:{labels:["2020","2025","2030","2035"],datasets:[{label:"탄소배출량",data:[100,80,50,30],borderColor:"#E63946",backgroundColor:"rgba(230, 57, 70, 0.2)",fill:!0}]},options:{responsive:!0,maintainAspectRatio:!1}})),f.value&&(k=new wt.Ay(f.value.getContext("2d"),{type:"bar",data:{labels:["2020","2025","2030","2035"],datasets:[{label:"ROI",data:[1.2,1.5,2,2.8],backgroundColor:"#264653"}]},options:{responsive:!0,maintainAspectRatio:!1}}))},W=e=>{let t=A(e),a=R(e),n=N(e),o=0,u=O(e),i=V(e);const s=P({tlc:t,tc:a,tlr:n,ptc:o,dlc:u,group:e}),r=q(e,i),d=X(l);return{bar:s,doughnut:r,table:d}},A=e=>{const t=t=>e.get(t)?.["송전설로 건설단가"]??0,a=t=>e.get(t)?[e.get(t).lat,e.get(t).lng]:null;let n=0;const l=a("765"),o=a("345");if(l&&o){const e=K(...l,...o),a=t("765");n+=e*a*1e6}const u=[...e].filter((([e])=>"154"===e)).map((([,e])=>[e.lat,e.lng]));if(o&&u.length>0){const e=t("345");u.forEach((([t,a])=>{const l=K(...o,t,a);n+=l*e*1e6}))}const i=a("22.9"),s=t("154");for(let r=0;r<u.length-1;r++){const[e,t]=u[r],[a,l]=u[r+1],o=K(e,t,a,l);n+=o*s*1e6}if(i&&u.length>0){const[e,t]=u[u.length-1],a=K(e,t,...i);n+=a*s*1e6}return Math.round(n)},R=e=>{const t=e.get("수요지역"),a=e.get("154");if(!t||!a)return 0;const n=1e3*Number(t["용량"]??0),l=Number((t["일별 전력 사용시간"]??"0").trim()),o=a["송전 접속단가"];if(!o)return 0;const u=Number(o["기본 단가"]??0),i=Number(o["사용 단가"]??0),s=n*i*l*365+n*u;return Math.round(s)},N=e=>{const t=e.keys().next().value,a=e.get("수요지역"),n=e.get("154");if(!a||!n)return 0;const l=n["송전 손실단가"];if(!l)return 0;const o=Number(l[t]??0),u=Number(a["용량"]??0),i=Number(a["일별 전력 사용시간"]??"0"),s=u*o*i*365;return Math.round(s)},O=e=>{const t=e.get("22.9"),a=e.get("수요지역");if(!t||!a)return 0;const n=K(t.lat,t.lng,a.lat,a.lng),l=t["배전망 건설 단가"]?.[0]?.costs,o=1e4*Object.values(l).reduce(((e,t)=>{const a=Number(t)||0;return e+a}),0),u=n*o;return Math.round(u)},V=e=>{let t=[];for(const[a,n]of e.entries()){if(!["태양광","풍력","해상풍력"].some((e=>a.startsWith(e))))continue;const e=a.startsWith("해상풍력")?"해상풍력":a.startsWith("풍력")?"풍력":"태양광",l="발전소 구축단가",o=n[l]?.[0];if(!o||!Array.isArray(o.costs))continue;const{constructionType:u,costs:i}=o,s="신축"===u,r="태양광"===e?"수요용량":"여유용량",d=Number(n[r]??0),c={};i.forEach((e=>{e.name&&null!=e.data&&(c[e.name]=Number(e.data)||0)}));let p=0;if("태양광"===e){const e=c["건설단가"]??0,t=c["유지비용"]??0,a=c["접속비용"]??0,n=c["태양광 거래 단가 (SMP)"]??0,l=d*n;p=s?e+t+a+l:t+a+l}else if("해상풍력"===e||"풍력"===e){const e=c["기자재 및 공사비"]??0,t=c["인허가/설계감리"]??0,a=c["기타 부대비"]??0,n=c["유지 비용"]??0,l=c["풍력 거래 단가"]??0,o=c["접속비용"]??0,u=d*l;p=s?e+t+a+n+u+o:n+u+o}t.push({type:e,label:a,cost:Math.round(1e3*p)})}return console.log("NWAsGroup : ",e),console.log("MWAs : ",t),t},K=(e,t,a,n)=>{const l=6371e3,o=Math.PI/180,u=e*o,i=a*o,s=(a-e)*o,r=(n-t)*o,d=Math.sin(s/2)**2+Math.cos(u)*Math.cos(i)*Math.sin(r/2)**2,c=2*Math.atan2(Math.sqrt(d),Math.sqrt(1-d));return l*c/1e3},D=()=>{y&&(y.destroy(),y=null),g&&(g.destroy(),g=null),b&&(b.destroy(),b=null),k&&(k.destroy(),k=null)},P=({tlc:e,tc:t,tlr:a,ptc:n=0,dlc:l,group:o})=>{const u=V(o),i=["송전선로","배전망",...u.map((e=>e.type))],s=[e+t+a+n,l,...u.map((e=>e.cost))],r=["#4285F4","#FB8C00",...u.map((e=>"태양광"===e.type?"#9E9E9E":"풍력"===e.type?"#4CAF50":"해상풍력"===e.type?"#00ACC1":"#CCCCCC"))];return{labels:i,datasets:[{label:"건설 비용",data:s,backgroundColor:r}]}},q=(e,t)=>{const a=A(e)+R(e)+N(e)+O(e);if(!t||"object"!==typeof t)return console.warn("❗ NWAs가 객체가 아님:",t),{labels:[],datasets:[{label:"NWAs 편익",data:[],backgroundColor:[]}]};const n=Object.entries(t).map((([,e])=>{const t=e.label||e.name||"이름 없음",n=a-(e.cost??0);return{name:t,benefit:isNaN(n)?0:n}}));return{labels:n.map((e=>e.name)),datasets:[{label:"NWAs 편익 비용",data:n.map((e=>e.benefit)),backgroundColor:["#9CA3AF","#FACC15","#4BC0C0","#FF6384","#36A2EB"].slice(0,n.length),borderWidth:1}]}},T={id:"centerText",beforeDraw(e){const{width:t,height:a,ctx:n}=e;n.save();const l=e.data.labels,o=e.data.datasets[0].data;n.font="bold 14px sans-serif",n.fillStyle="#333",n.textAlign="center",n.textBaseline="middle";const u=l.map(((e,t)=>{const a=o[t],n=(a/1e6).toLocaleString();return`${e}: ${n} 백만 원`})),i=20,s=-.5*(u.length-1)*i;u.forEach(((e,l)=>{n.fillText(e,t/2,a/2+s+l*i)})),n.restore()}},X=e=>e.map(((e,t)=>{const a=A(e),n=R(e),l=N(e),o=0,u=O(e),i=V(e),s=a+n+l+o+u,r=Object.values(i).reduce(((e,t)=>e+(t.cost??t.value??0)),0),d=s-r;return{"전력망":`경로 ${t+1}`,"송배전망_건설비용":s.toLocaleString()+"원","NWAs_건설비용":r.toLocaleString()+"원","NWAs_편익":d.toLocaleString()+"원"}})),M=async()=>{C.value=[],l.forEach((e=>{if(!e)return;const t=W(e);C.value.push(t)})),await(0,i.dY)();const e=w.value;e.style.display="block",await ht()().set({margin:.5,filename:"전력망_전체_분석.pdf",image:{type:"jpeg",quality:.98},html2canvas:{scale:2},jsPDF:{unit:"in",format:"a4",orientation:"portrait"},pagebreak:{mode:["css","legacy"]}}).from(e).save()},J=[],$=[],B=(e,t)=>{if(!e||!C.value[t])return;J[t]&&J[t].destroy();const a=e.getContext("2d");J[t]=new wt.Ay(a,{type:"bar",data:C.value[t].bar,options:{responsive:!1,animation:!1,plugins:{legend:{display:!1}},scales:{y:{beginAtZero:!0,title:{display:!0,text:"비용 (백만원)"},ticks:{callback:function(e){return(e/1e6).toLocaleString()+"백만"}}}}}})},z=(e,t)=>{if(!e||!C.value[t])return;$[t]&&$[t].destroy();const a=e.getContext("2d");$[t]=new wt.Ay(a,{type:"doughnut",data:C.value[t].doughnut,options:{responsive:!1,animation:!1,plugins:{legend:{position:"bottom"}}}})};return(0,i.sV)((()=>{const e=l[F.value],t=W(e);_.value=t.bar,L.value=t.doughnut,h.value=t.table,S()})),(0,i.wB)(o,S),(0,i.wB)(F,(async()=>{await(0,i.dY)(),null!=F.value&&(E(),S())})),(e,t)=>((0,i.uX)(),(0,i.CE)(i.FK,null,[(0,i.Lk)("div",St,[(0,i.bF)(ut.I,{class:"plot-area"},{default:(0,i.k6)((()=>[(0,i.bF)(Lt.h,{modelValue:o.value,"onUpdate:modelValue":t[0]||(t[0]=e=>o.value=e),centered:""},{default:(0,i.k6)((()=>[(0,i.bF)(Ft.U,{value:"cost"},{default:(0,i.k6)((()=>t[3]||(t[3]=[(0,i.eW)("건설 및 편익 비용")]))),_:1}),(0,i.bF)(Ft.U,{value:"carbon"},{default:(0,i.k6)((()=>t[4]||(t[4]=[(0,i.eW)("탄소배출량")]))),_:1}),(0,i.bF)(Ft.U,{value:"roi"},{default:(0,i.k6)((()=>t[5]||(t[5]=[(0,i.eW)("ROI")]))),_:1})])),_:1},8,["modelValue"]),(0,i.bF)(ce.L,{justify:"end",align:"center"},{default:(0,i.k6)((()=>[(0,i.bF)(pe.B,{cols:"auto"},{default:(0,i.k6)((()=>[(0,i.bF)(_t.d4,{modelValue:F.value,"onUpdate:modelValue":t[1]||(t[1]=e=>F.value=e),items:I.value,"item-title":"title","item-value":"value",label:"경로 선택",density:"compact",variant:"outlined",style:{"max-width":"250px"},class:"mb-0","hide-details":""},null,8,["modelValue","items"])])),_:1}),(0,i.bF)(m.D,{onClick:M,color:"primary"},{default:(0,i.k6)((()=>t[6]||(t[6]=[(0,i.eW)(" 보고서 다운로드 ")]))),_:1})])),_:1}),(0,i.bF)(It.r3,{modelValue:o.value,"onUpdate:modelValue":t[2]||(t[2]=e=>o.value=e),class:"chartContent"},{default:(0,i.k6)((()=>[(0,i.bF)(Et.m,{value:"cost"},{default:(0,i.k6)((()=>[(0,i.bF)(ce.L,null,{default:(0,i.k6)((()=>[(0,i.bF)(pe.B,{cols:"6"},{default:(0,i.k6)((()=>[t[7]||(t[7]=(0,i.Lk)("h3",null,"건설 비용",-1)),(0,i.Lk)("canvas",{ref_key:"barChart",ref:d},null,512)])),_:1}),(0,i.bF)(pe.B,{cols:"6"},{default:(0,i.k6)((()=>[t[8]||(t[8]=(0,i.Lk)("h3",null,"편익 비용",-1)),(0,i.Lk)("canvas",{ref_key:"doughnutChart",ref:c},null,512)])),_:1})])),_:1})])),_:1}),(0,i.bF)(Et.m,{value:"carbon"},{default:(0,i.k6)((()=>[(0,i.bF)(ce.L,null,{default:(0,i.k6)((()=>[(0,i.bF)(pe.B,{cols:"12"},{default:(0,i.k6)((()=>[t[9]||(t[9]=(0,i.Lk)("h3",null,"탄소 배출량 비교",-1)),(0,i.Lk)("canvas",{ref_key:"carbonChart",ref:p},null,512)])),_:1})])),_:1})])),_:1}),(0,i.bF)(Et.m,{value:"roi"},{default:(0,i.k6)((()=>[(0,i.bF)(ce.L,null,{default:(0,i.k6)((()=>[(0,i.bF)(pe.B,{cols:"12"},{default:(0,i.k6)((()=>[t[10]||(t[10]=(0,i.Lk)("h3",null,"ROI 분석",-1)),(0,i.Lk)("canvas",{ref_key:"roiChart",ref:f},null,512)])),_:1})])),_:1})])),_:1})])),_:1},8,["modelValue"])])),_:1}),(0,i.bF)(ut.I,{class:"table-container"},{default:(0,i.k6)((()=>[(0,i.bF)(v.J,{class:"custom-card h-auto"},{default:(0,i.k6)((()=>[(0,i.bF)(Ct.Py,{items:h.value,class:"custom-table","hide-default-footer":"",tabindex:"-1"},null,8,["items"])])),_:1})])),_:1})]),(0,i.Lk)("div",{ref_key:"pdfArea",ref:w,class:"pdf-export-area"},[t[16]||(t[16]=(0,i.Lk)("h1",null,"NWAs 및 송배전시스템의 편익 분석 시뮬레이션 결과",-1)),t[17]||(t[17]=(0,i.Lk)("hr",null,null,-1)),t[18]||(t[18]=(0,i.Lk)("p",{class:"summary"},"Summary",-1)),(0,i.Lk)("p",null,[t[11]||(t[11]=(0,i.eW)(" 수요지역 ( ")),(0,i.Lk)("strong",null,(0,r.v_)((0,s.R1)(l)[0].get("수요지역").주소)+", lat : "+(0,r.v_)((0,s.R1)(l)[0].get("수요지역").lat)+", lng : "+(0,r.v_)((0,s.R1)(l)[0].get("수요지역").lng),1),t[12]||(t[12]=(0,i.eW)(" ) 기준 필요전력 ")),(0,i.Lk)("strong",null,(0,r.v_)((0,s.R1)(l)[0].get("수요지역").용량),1),t[13]||(t[13]=(0,i.eW)(" MW 증설 시 NWAs 기반 편익분석 결과는 다음과 같음 "))]),t[19]||(t[19]=(0,i.Fv)('<section data-v-71accc27><h3 data-v-71accc27>1. 송배전망 증설 비용 요약</h3><p data-v-71accc27> 송배전망 건설비용은 송전선로 건설비용(TLC<sup data-v-71accc27>A</sup>), 송전접속 비용(TC<sup data-v-71accc27>B</sup>), 송전 손실비용(TLR<sup data-v-71accc27>C</sup>) 및 전력거래 비용(PTC<sup data-v-71accc27>D</sup>)의 합으로 산출됨. </p><div class="expression" data-v-71accc27><p data-v-71accc27><strong data-v-71accc27>A)</strong> TLC = P<sub data-v-71accc27>d</sub> · ∑<sub data-v-71accc27>i</sub> C<sub data-v-71accc27>L<sub data-v-71accc27>i</sub></sub>L<sub data-v-71accc27>p,i</sub></p><p data-v-71accc27><strong data-v-71accc27>B)</strong> TC = P<sub data-v-71accc27>d</sub> · C<sub data-v-71accc27>TC</sub> · j</p><p data-v-71accc27><strong data-v-71accc27>C)</strong> TLR = P<sub data-v-71accc27>d</sub> · L<sub data-v-71accc27>TLR</sub></p><p data-v-71accc27><strong data-v-71accc27>D)</strong> PTC = P<sub data-v-71accc27>d</sub> · P<sub data-v-71accc27>E</sub></p></div></section>',1)),(0,i.bF)(Ct.Py,{items:h.value,class:"custom-table export-table","hide-default-footer":"",tabindex:"-1"},null,8,["items"]),((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)((0,s.R1)(a),((e,a)=>((0,i.uX)(),(0,i.CE)("div",{key:a,style:{"page-break-after":"auto"}},[(0,i.Lk)("h3",null,(0,r.v_)(a+2)+". 경로 "+(0,r.v_)(a+1)+" 분석 결과",1),(0,i.Lk)("div",Wt,[(0,i.Lk)("div",xt,[t[14]||(t[14]=(0,i.Lk)("h3",null,"건설 비용",-1)),(0,i.Lk)("canvas",{ref_for:!0,ref:e=>B(e,a),width:"300",height:"250",calss:"barPlot"},null,512)]),(0,i.Lk)("div",At,[t[15]||(t[15]=(0,i.Lk)("h3",null,"편익 비용",-1)),(0,i.Lk)("canvas",{ref_for:!0,ref:e=>z(e,a),width:"400",height:"250",class:"doughnutPlot"},null,512)])])])))),128))],512)],64))}};const Nt=(0,I.A)(Rt,[["__scopeId","data-v-71accc27"]]);var Ot=Nt;const Vt=[{path:"/",redirect:"/step1"},{path:"/step1",name:"step1",component:We,meta:{step:1}},{path:"/step2",name:"step2",component:ot,meta:{step:2}},{path:"/step3",name:"step3",component:bt,meta:{step:3}},{path:"/step4",name:"step4",component:Ot,meta:{step:4}}],Kt=(0,d.aE)({history:(0,d.LA)(),routes:Vt});Kt.beforeEach((async(e,t,a)=>{await(0,i.dY)();const n=c(),l=e.meta.step,o=t.meta.step;if("number"===typeof l&&"number"===typeof o&&l<o){console.log(`🔄 Step${o} → Step${l} 이동 → 이후 Step 초기화`);for(let e=o;e>l;e--){const t=`step${e}`;console.log(`❌ ${t} 완료 취소`),n.setStepCondition(t,!1)}}a()}));var Dt=Kt,Pt=(a(5524),a(5790)),qt=(0,Pt.$N)();l(),(0,n.Ef)(se).use(Dt).use(qt).use(o.SK).use((0,u.Ey)()).mount("#app")}},t={};function a(n){var l=t[n];if(void 0!==l)return l.exports;var o=t[n]={exports:{}};return e[n].call(o.exports,o,o.exports,a),o.exports}a.m=e,function(){var e=[];a.O=function(t,n,l,o){if(!n){var u=1/0;for(d=0;d<e.length;d++){n=e[d][0],l=e[d][1],o=e[d][2];for(var i=!0,s=0;s<n.length;s++)(!1&o||u>=o)&&Object.keys(a.O).every((function(e){return a.O[e](n[s])}))?n.splice(s--,1):(i=!1,o<u&&(u=o));if(i){e.splice(d--,1);var r=l();void 0!==r&&(t=r)}}return t}o=o||0;for(var d=e.length;d>0&&e[d-1][2]>o;d--)e[d]=e[d-1];e[d]=[n,l,o]}}(),function(){a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,{a:t}),t}}(),function(){var e,t=Object.getPrototypeOf?function(e){return Object.getPrototypeOf(e)}:function(e){return e.__proto__};a.t=function(n,l){if(1&l&&(n=this(n)),8&l)return n;if("object"===typeof n&&n){if(4&l&&n.__esModule)return n;if(16&l&&"function"===typeof n.then)return n}var o=Object.create(null);a.r(o);var u={};e=e||[null,t({}),t([]),t(t)];for(var i=2&l&&n;"object"==typeof i&&!~e.indexOf(i);i=t(i))Object.getOwnPropertyNames(i).forEach((function(e){u[e]=function(){return n[e]}}));return u["default"]=function(){return n},a.d(o,u),o}}(),function(){a.d=function(e,t){for(var n in t)a.o(t,n)&&!a.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}}(),function(){a.f={},a.e=function(e){return Promise.all(Object.keys(a.f).reduce((function(t,n){return a.f[n](e,t),t}),[]))}}(),function(){a.u=function(e){return"js/"+(53===e?"webfontloader":e)+"."+{53:"0414c632",234:"bb71d3c9",353:"a818acae"}[e]+".js"}}(),function(){a.miniCssF=function(e){}}(),function(){a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={},t="nwas_site:";a.l=function(n,l,o,u){if(e[n])e[n].push(l);else{var i,s;if(void 0!==o)for(var r=document.getElementsByTagName("script"),d=0;d<r.length;d++){var c=r[d];if(c.getAttribute("src")==n||c.getAttribute("data-webpack")==t+o){i=c;break}}i||(s=!0,i=document.createElement("script"),i.charset="utf-8",i.timeout=120,a.nc&&i.setAttribute("nonce",a.nc),i.setAttribute("data-webpack",t+o),i.src=n),e[n]=[l];var p=function(t,a){i.onerror=i.onload=null,clearTimeout(m);var l=e[n];if(delete e[n],i.parentNode&&i.parentNode.removeChild(i),l&&l.forEach((function(e){return e(a)})),t)return t(a)},m=setTimeout(p.bind(null,void 0,{type:"timeout",target:i}),12e4);i.onerror=p.bind(null,i.onerror),i.onload=p.bind(null,i.onload),s&&document.head.appendChild(i)}}}(),function(){a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){a.p="/nwas.github.io/"}(),function(){var e={524:0};a.f.j=function(t,n){var l=a.o(e,t)?e[t]:void 0;if(0!==l)if(l)n.push(l[2]);else{var o=new Promise((function(a,n){l=e[t]=[a,n]}));n.push(l[2]=o);var u=a.p+a.u(t),i=new Error,s=function(n){if(a.o(e,t)&&(l=e[t],0!==l&&(e[t]=void 0),l)){var o=n&&("load"===n.type?"missing":n.type),u=n&&n.target&&n.target.src;i.message="Loading chunk "+t+" failed.\n("+o+": "+u+")",i.name="ChunkLoadError",i.type=o,i.request=u,l[1](i)}};a.l(u,s,"chunk-"+t,t)}},a.O.j=function(t){return 0===e[t]};var t=function(t,n){var l,o,u=n[0],i=n[1],s=n[2],r=0;if(u.some((function(t){return 0!==e[t]}))){for(l in i)a.o(i,l)&&(a.m[l]=i[l]);if(s)var d=s(a)}for(t&&t(n);r<u.length;r++)o=u[r],a.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return a.O(d)},n=self["webpackChunknwas_site"]=self["webpackChunknwas_site"]||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))}();var n=a.O(void 0,[504],(function(){return a(3668)}));n=a.O(n)})();
//# sourceMappingURL=app.d28c4b26.js.map